library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file="C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv", header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000)
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
View(Ricker.curve)
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
?read.csv
fishData <- read.csv(file = filename, header=T)
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "~\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Skeena <- read.csv(file = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv", header = T)
Skeena <- read.csv(file = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv", header = T)
labels(Skeena)
Skeena.spawners <- Skeena[,"Spawners"]
Skeena.spawners
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, fileName, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, fileName = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, fileName, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = fileName, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, fileName = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, data, ...){
library(bbmle)
require(bbmle)
fishData <- read.csv(file = data, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
View(Ricker.curve)
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, data = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = data, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header=T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = "filename", header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:/Users/Andrew Chin/Downloads/HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", coef(bestRicker), "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:/Users/Andrew Chin/Downloads/HW3 Skeena sockeye.csv")
#Alanna Greene
#Homework 3
#Fish 553
#Q1 a
rickerdata<-read.csv("Downloads/HW3+Skeena+sockeye.csv")
View(rickerdata)
Ricker.curve<- function(Ricker.a, Ricker.b, sigma, filename) {
rickerdata<- read.csv(file=filename)
recruits<- (Ricker.a* rickerdata$Spawners) *exp(-Ricker.b*rickerdata$Spawners)
nlgl_R <- -sum(dnorm(x= rickerdata$Recruits, mean=recruits, sd=sigma, log=TRUE))
return(nlgl_R)
}
Ricker.curve(Ricker.a=5, Ricker.b=0.001, sigma=1000, filename ="Downloads/HW3+Skeena+sockeye.csv")
#==Question 1
# Ricker curve (Ricker 1954)
# R = a*S*exp(-b*S)
# R: recruits, S: spawners, a and b are growth parameters to estimate
setwd("C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3")
Skeena <- read.csv(file = "HW3 Skeena sockeye.csv", header = T)
labels(Skeena)
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
for (i in 1:nspawners) {
modelRicker <- Ricker.a*spawners[i]*exp(-Ricker.b*spawners[i])
}
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRicker <- -1*logLik(Ricker.MLE)[1]   #because returns log likelihood
cat("Parameters", bestRicker, "\n", "\n", "Max Likelihood", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "HW3 Skeena sockeye.csv")
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "HW3 Skeena sockeye.csv")
?dnorm
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
modelRicker <- Ricker.a*spawners*exp(-Ricker.b*spawners)
Ricker.MLE <- -sum(dnorm(x=recruits, mean = model.Ricker, sd=sigma, log=TRUE))
cat("estimated MLE", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
library(bbmle)
require(bbmle)
fishData <- read.csv(file = filename, header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
modelRicker <- Ricker.a*spawners*exp(-Ricker.b*spawners)
Ricker.MLE <- -sum(dnorm(x=recruits, mean = modelRicker, sd=sigma, log=TRUE))
cat("estimated MLE", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "HW3 Skeena sockeye.csv")
Ricker.curve <- function(Ricker.a, Ricker.b, sigma, filename) {
fishData <- read.csv(file = filename, header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
modelRicker <- Ricker.a*spawners*exp(-Ricker.b*spawners)
Ricker.MLE <- -sum(dnorm(x=recruits, mean = modelRicker, sd=sigma, log=TRUE))
cat("estimated MLE", Ricker.MLE)
}
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
library(bbmle)
require(bbmle)
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a, Ricker.b, sigma),
method = "Nelder-Mead")
bestRickerparameters <- -1*logLik(Ricker.MLE)[1]
cat("Parameters", bestRicker, "\n", "\n", "Max Likelihood", Ricker.MLE)
library(bbmle)
require(bbmle)
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead")
bestRickerparameters <- -1*logLik(Ricker.MLE)[1]
cat("Parameters", bestRicker, "\n", "\n", "Max Likelihood", Ricker.MLE)
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
?mle2
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename="C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
bestRickerparameters <- -1*logLik(Ricker.MLE)[1]
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename="C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
require("bbmle")
rickerlog<-mle2(minuslogl=Ricker.curve,
start=list(Ricker.a=5, Ricker.b=0.001, sigma=1000),
method="Nelder-Mead",
data= list(filename= "Downloads/HW3+Skeena+sockeye.csv"))
library(bbmle)
require(bbmle)
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
Ricker.curve(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
View(MLE.res)
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
rickerdata<-read.csv("Downloads/HW3+Skeena+sockeye.csv")
View(rickerdata)
Ricker.curve<- function(Ricker.a, Ricker.b, sigma, filename) {
rickerdata<- read.csv(file=filename)
recruits<- (Ricker.a* rickerdata$Spawners) *exp(-Ricker.b*rickerdata$Spawners)
nlgl_R <- -sum(dnorm(x= rickerdata$Recruits, mean=recruits, sd=sigma, log=TRUE))
return(nlgl_R)
}
Ricker.curve(Ricker.a=5, Ricker.b=0.001, sigma=1000, filename ="Downloads/HW3+Skeena+sockeye.csv")
library("bbmle")
require("bbmle")
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
coef(Ricker.MLE)
Ricker.MLE
BevertonHolt <- function(BHa, BHb, sigma, filename) {
fishData <- read.csv(file = filename, header = T)
spawners <- fishData[,"Spawners"]
recruits <- fishData[,"Recruits"]
nspawners <- length(spawners)
eggcarton <- vector(length=nspawners)
modelBH <- (BHa*spawners)/(BHb+spawners)
BH.MLE <- -sum(dnorm(x=recruits, mean = modelBH, sd=sigma, log=TRUE))
cat("estimated MLE", BH.MLE)
}
BevertonHolt(BHa = 5000, BHb = 1000, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5, BHb = 0.001, sigma = 1000),
method = "L-BFGS-B")
BevertonHolt.MLE
library("bbmle")
require("bbmle")
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5, BHb = 0.001, sigma = 1000),
method = "L-BFGS-B")
BevertonHolt.MLE
BevertonHolt(BHa = 5000, BHb = 1000, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5, BHb = 0.001, sigma = 1000),
method = "L-BFGS-B")
library("bbmle")
require("bbmle")
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5, BHb = 0.001, sigma = 1000),
method = "L-BFGS-B",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
BevertonHolt.MLE
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5000, BHb = 1000, sigma = 1000),
method = "L-BFGS-B",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
BevertonHolt.MLE
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
Ricker.MLE
BevertonHolt<- function(BHa, BHb, sigma, filename) {
BHdata<- read.csv(file=filename)
bhR<- (BHa*BHdata$Spawners)/(BHb +BHdata$Spawners)
nlgl_BH <- -sum(dnorm(x= BHdata$Recruits, mean=bhR, sd=sigma, log=TRUE))
return(nlgl_BH)
}
BevertonHolt(BHa=5000, BHb= 1000, sigma = 1000, filename ="Downloads/HW3+Skeena+sockeye.csv")
BevHlog<-mle2(minuslogl=BevertonHolt,
start=list(BHa=5, BHb=0.001, sigma=1000),
method="L-BFGS-B",
data= list(filename= "Downloads/HW3+Skeena+sockeye.csv"))
BevertonHolt(BHa = 5000, BHb = 1000, sigma = 1000, filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv")
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5000, BHb = 1000, sigma = 1000),
method = "L-BFGS-B",
lower = list(BHa = 500, BHb = 100, sigma = 500),
upper = list(BHa = 7500, BHb = 2500, sigma = 2500))
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5000, BHb = 1000, sigma = 1000),
method = "L-BFGS-B",
lower = list(BHa = 500, BHb = 100, sigma = 500),
upper = list(BHa = 7500, BHb = 2500, sigma = 2500),
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
BevertonHolt.MLE
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5000, BHb = 1000, sigma = 1000),
method = "L-BFGS-B",
lower = list(BHa = 1000, BHb = 500, sigma = 500),
upper = list(BHa = 9000, BHb = 1500, sigma = 1500),
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
BevertonHolt.MLE <- mle2(minuslogl = BevertonHolt,
start = list(BHa = 5000, BHb = 1000, sigma = 1000),
method = "L-BFGS-B",
lower = list(BHa = 1000, BHb = 500, sigma = 500),
upper = list(BHa = 9000, BHb = 1500, sigma = 1500),
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
BevertonHolt.MLE
AIC <- function(lnF, p, n) {
AIC <- 2*lnL + 2*p + ((2*p*(p+1))/(n-p-1))
return(AIC)
}
Skeena.sockeye <- read.csv(file = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv", header=T)
AIC(lnF = Ricker.MLE, p = 3, n = length(Skeena.sockeye$Year))
AIC <- function(lnF, p, n) {
AIC <- 2*lnF + 2*p + ((2*p*(p+1))/(n-p-1))
return(AIC)
}
AIC(lnF = Ricker.MLE, p = 3, n = length(Skeena.sockeye$Year))
AIC(lnL = Ricker.MLE, p = 3, n = length(Skeena.sockeye$Year))
AIC <- function(lnL, p, n) {
AIC <- 2*lnL + 2*p + ((2*p*(p+1))/(n-p-1))
return(AIC)
}
# Ricker AIC
AIC(lnL = Ricker.MLE, p = 3, n = length(Skeena.sockeye$Year))
Ricker.MLE <- mle2(minuslogl = Ricker.curve,
start = list(Ricker.a = 5, Ricker.b = 0.001, sigma = 1000),
method = "Nelder-Mead",
data = list(filename = "C:\\Users\\Andrew Chin\\Documents\\UW AU19\\FISH 552_3\\FISH.552_workspace\\553_HW3\\HW3 Skeena sockeye.csv"))
Ricker.MLE
AIC(lnL = 357.91, p = 3, n = length(Skeena.sockeye$Year))
BevertonHolt.MLE
# Beverton-Holt
AIC(lnL = 358.31, p = 3, n = length(Skeena.sockeye$Year))
